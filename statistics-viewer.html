<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gwent Classic - Statistics Viewer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #e8e8e8;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.8;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .stat-card h3 {
            font-size: 1.4em;
            margin-bottom: 20px;
            color: #ffd700;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
            padding-bottom: 10px;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }
        
        .stat-label {
            font-weight: 500;
            color: #b8b8b8;
        }
        
        .stat-value {
            font-weight: bold;
            color: #ffffff;
        }
        
        .stat-percentage {
            color: #4ade80;
        }
        
        .stat-negative {
            color: #f87171;
        }
        
        .stat-neutral {
            color: #fbbf24;
        }
        
        .faction-stats {
            grid-column: span 2;
        }
        
        .faction-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .faction-item {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .faction-name {
            font-weight: bold;
            margin-bottom: 10px;
            color: #ffd700;
        }
        
        .faction-winrate {
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .winrate-high { color: #4ade80; }
        .winrate-medium { color: #fbbf24; }
        .winrate-low { color: #f87171; }
        
        .records-section {
            grid-column: span 2;
        }
        
        .record-item {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05));
            border: 1px solid rgba(255, 215, 0, 0.3);
        }
        
        .record-value {
            color: #ffd700;
            font-size: 1.1em;
        }
        
        .recent-games {
            grid-column: span 2;
        }
        
        .game-item {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid;
        }
        
        .game-win { border-left-color: #4ade80; }
        .game-loss { border-left-color: #f87171; }
        .game-draw { border-left-color: #fbbf24; }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .game-result {
            font-weight: bold;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9em;
        }
        
        .game-win .game-result { background: #4ade80; color: #000; }
        .game-loss .game-result { background: #f87171; color: #000; }
        .game-draw .game-result { background: #fbbf24; color: #000; }
        
        .game-details {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .controls {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .btn {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #000;
            border: none;
            padding: 12px 24px;
            margin: 0 10px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #f87171, #ef4444);
        }
        
        .btn-danger:hover {
            box-shadow: 0 5px 15px rgba(248, 113, 113, 0.3);
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2em;
            color: #b8b8b8;
        }
        
        .no-data {
            text-align: center;
            padding: 50px;
            color: #b8b8b8;
            font-style: italic;
        }
        
        .chart-container {
            height: 200px;
            margin-top: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            display: flex;
            align-items: end;
            padding: 10px;
            gap: 2px;
        }
        
        .chart-bar {
            background: linear-gradient(to top, #ffd700, #ffed4e);
            border-radius: 2px 2px 0 0;
            min-width: 20px;
            transition: height 0.3s ease;
        }
        
        .chart-label {
            font-size: 0.8em;
            text-align: center;
            margin-top: 5px;
            color: #b8b8b8;
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .faction-stats, .records-section, .recent-games {
                grid-column: span 1;
            }
            
            .faction-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Gwent Classic Statistics</h1>
            <p>Your comprehensive gaming profile and performance metrics</p>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="refreshStats()">üîÑ Refresh Stats</button>
            <button class="btn" onclick="exportStats()">üìä Export Data</button>
            <button class="btn btn-danger" onclick="clearStats()">üóëÔ∏è Clear Stats</button>
        </div>
        
        <div id="statsContent" class="loading">
            Loading statistics...
        </div>
    </div>

    <script>
        let statsTracker = null;
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Wait a bit for the stats tracker to initialize
            setTimeout(() => {
                if (window.statsTracker) {
                    statsTracker = window.statsTracker;
                    displayStats();
                } else {
                    document.getElementById('statsContent').innerHTML = 
                        '<div class="no-data">Statistics tracker not available. Please play a game first to initialize tracking.</div>';
                }
            }, 1000);
        });
        
        function displayStats() {
            if (!statsTracker) {
                document.getElementById('statsContent').innerHTML = 
                    '<div class="no-data">Statistics tracker not available.</div>';
                return;
            }
            
            const stats = statsTracker.getStatsSummary();
            const content = document.getElementById('statsContent');
            
            if (!stats.profile.totalGames) {
                content.innerHTML = '<div class="no-data">No games played yet. Start playing to see your statistics!</div>';
                return;
            }
            
            content.innerHTML = `
                <div class="stats-grid">
                    <!-- Profile Overview -->
                    <div class="stat-card">
                        <h3>üë§ Profile Overview</h3>
                        <div class="stat-item">
                            <span class="stat-label">Total Games</span>
                            <span class="stat-value">${stats.profile.totalGames}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Wins</span>
                            <span class="stat-value">${stats.profile.wins}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Losses</span>
                            <span class="stat-value">${stats.profile.losses}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Draws</span>
                            <span class="stat-value">${stats.profile.draws}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Win Rate</span>
                            <span class="stat-value stat-percentage">${stats.profile.winRate.toFixed(1)}%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Last Played</span>
                            <span class="stat-value">${formatDate(stats.profile.lastPlayed)}</span>
                        </div>
                    </div>
                    
                    <!-- Favorites -->
                    <div class="stat-card">
                        <h3>‚≠ê Favorites</h3>
                        <div class="stat-item">
                            <span class="stat-label">Favorite Faction</span>
                            <span class="stat-value">${formatFaction(stats.profile.mostUsedFaction)}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Favorite Leader</span>
                            <span class="stat-value">${stats.profile.mostUsedLeader || 'None'}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Favorite Card</span>
                            <span class="stat-value">${stats.profile.favoriteCard || 'None'}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Session Games</span>
                            <span class="stat-value">${stats.sessionStats.gamesPlayed}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Session Duration</span>
                            <span class="stat-value">${formatDuration(Date.now() - stats.sessionStats.startTime)}</span>
                        </div>
                    </div>
                    
                    <!-- Faction Performance -->
                    <div class="stat-card faction-stats">
                        <h3>üè∞ Faction Performance</h3>
                        <div class="faction-grid">
                            ${Object.entries(stats.factions)
                                .filter(([_, faction]) => faction.games > 0)
                                .sort(([_, a], [__, b]) => b.games - a.games)
                                .map(([faction, data]) => `
                                    <div class="faction-item">
                                        <div class="faction-name">${formatFaction(faction)}</div>
                                        <div class="stat-item">
                                            <span class="stat-label">Games</span>
                                            <span class="stat-value">${data.games}</span>
                                        </div>
                                        <div class="stat-item">
                                            <span class="stat-label">Win Rate</span>
                                            <span class="faction-winrate ${getWinrateClass(data.winRate)}">${data.winRate.toFixed(1)}%</span>
                                        </div>
                                    </div>
                                `).join('')}
                        </div>
                    </div>
                    
                    <!-- Records -->
                    <div class="stat-card records-section">
                        <h3>üèÜ Records & Achievements</h3>
                        <div class="stat-item record-item">
                            <span class="stat-label">Most Units in Hand</span>
                            <span class="stat-value record-value">${stats.records.mostUnitsInHand}</span>
                        </div>
                        <div class="stat-item record-item">
                            <span class="stat-label">Most Units on Board</span>
                            <span class="stat-value record-value">${stats.records.mostUnitsOnBoard}</span>
                        </div>
                        <div class="stat-item record-item">
                            <span class="stat-label">Longest Game</span>
                            <span class="stat-value record-value">${formatDuration(stats.records.longestGame)}</span>
                        </div>
                        <div class="stat-item record-item">
                            <span class="stat-label">Shortest Game</span>
                            <span class="stat-value record-value">${formatDuration(stats.records.shortestGame)}</span>
                        </div>
                        <div class="stat-item record-item">
                            <span class="stat-label">Most Cards Played</span>
                            <span class="stat-value record-value">${stats.records.mostCardsPlayed}</span>
                        </div>
                    </div>
                    
                    <!-- Recent Games -->
                    <div class="stat-card recent-games">
                        <h3>üìú Recent Games</h3>
                        ${stats.recentGames.length > 0 ? 
                            stats.recentGames.reverse().map(game => `
                                <div class="game-item game-${game.finalResult}">
                                    <div class="game-header">
                                        <span class="game-result">${game.finalResult.toUpperCase()}</span>
                                        <span class="game-details">${formatDate(game.timestamp)}</span>
                                    </div>
                                    <div class="game-details">
                                        Deck: ${game.playerDeck || 'Unknown'} | 
                                        Leader: ${game.playerLeader || 'Unknown'} | 
                                        Duration: ${formatDuration(game.duration)} | 
                                        Cards: ${game.cardsPlayed.length} | 
                                        Max Hand: ${game.maxUnitsInHand} | 
                                        Max Board: ${game.maxUnitsOnBoard}
                                    </div>
                                </div>
                            `).join('') : 
                            '<div class="no-data">No recent games to display</div>'
                        }
                    </div>
                </div>
            `;
        }
        
        function formatFaction(faction) {
            if (!faction) return 'None';
            
            const factionNames = {
                'northern_realms': 'Northern Realms',
                'monsters': 'Monsters',
                'nilfgaard': 'Nilfgaard',
                'scoiatael': 'Scoia\'tael',
                'skellige': 'Skellige',
                'syndicate': 'Syndicate',
                'toussaint': 'Toussaint',
                'lyria_rivia': 'Lyria & Rivia',
                'witchers': 'Witchers'
            };
            
            return factionNames[faction] || faction;
        }
        
        function formatDate(timestamp) {
            if (!timestamp) return 'Never';
            
            const date = new Date(timestamp);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 60000) return 'Just now';
            if (diff < 3600000) return `${Math.floor(diff / 60000)}m ago`;
            if (diff < 86400000) return `${Math.floor(diff / 3600000)}h ago`;
            if (diff < 604800000) return `${Math.floor(diff / 86400000)}d ago`;
            
            return date.toLocaleDateString();
        }
        
        function formatDuration(milliseconds) {
            if (!milliseconds) return '0s';
            
            const seconds = Math.floor(milliseconds / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            
            if (hours > 0) {
                return `${hours}h ${minutes % 60}m`;
            } else if (minutes > 0) {
                return `${minutes}m ${seconds % 60}s`;
            } else {
                return `${seconds}s`;
            }
        }
        
        function getWinrateClass(winrate) {
            if (winrate >= 60) return 'winrate-high';
            if (winrate >= 40) return 'winrate-medium';
            return 'winrate-low';
        }
        
        function refreshStats() {
            if (statsTracker) {
                displayStats();
            }
        }
        
        function exportStats() {
            if (statsTracker) {
                statsTracker.exportStats();
            }
        }
        
        function clearStats() {
            if (statsTracker) {
                statsTracker.clearStats();
                setTimeout(() => {
                    displayStats();
                }, 100);
            }
        }
        
        // Auto-refresh every 30 seconds
        setInterval(() => {
            if (statsTracker) {
                refreshStats();
            }
        }, 30000);
    </script>
</body>
</html>
